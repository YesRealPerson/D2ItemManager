let response="";const main=async()=>{let e=new URLSearchParams(window.location.search);try{response=await fetch("https://d2oauth.spark952.workers.dev?code="+e.get("code")),(response=JSON.parse(await response.json())).access_token&&response.refresh_token&&response.membership_id?(localStorage.setItem("access",response.access_token),localStorage.setItem("refresh",response.refresh_token),localStorage.setItem("accountID",response.membership_id),window.location.href="./app.html"):document.body.innerText="Authentication failed!\nError:\n"+response.error+"\n"+response.error_description}catch(s){document.body.innerText="Authentication failed!\nError:\n"+s}};main();